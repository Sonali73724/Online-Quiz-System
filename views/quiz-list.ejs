<%- include('sidebar'); %>

<main>
    <h1>Quiz List</h1>
    <table class="quiz-table">
        <thead>
            <tr>
                <th>ID</th>
                <th>Quiz Name</th>
                <th>Duration (minutes)</th>
                <th>Number of Questions</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            <% quizzes.forEach(quiz => { %>
                <tr>
                    <td><%= quiz.id %></td>
                    <td><%= quiz.name %></td>
                    <td><%= quiz.duration %></td>
                    <td><%= quiz.question_count %></td>
                    <td>
                        <button class="btn btn-delete" data-quiz-id="<%= quiz.id %>">Delete</button>
                    </td>
                </tr>
            <% }); %>
        </tbody>
    </table>
</main>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const quizTable = document.querySelector('.quiz-table');

    quizTable.addEventListener('click', function(e) {
        if (e.target.classList.contains('btn-delete')) {
            const quizId = e.target.dataset.quizId;
            if (confirm('Are you sure you want to delete this quiz?')) {
                fetch(`/admin/delete-quiz/${quizId}`, { method: 'DELETE' })
                    .then(response => response.json())
                    .then(data => {
                        if (data.success) {
                            e.target.closest('tr').remove();
                            alert('Quiz deleted successfully');
                        } else {
                            alert('Error deleting quiz: ' + data.message);
                        }
                    })
                    .catch(error => {
                        console.error('Error:', error);
                        alert('An error occurred while deleting the quiz.');
                    });
            }
        }
    });
});
</script>
